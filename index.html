<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NFT –ö–µ–π—Å—ã</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        body {
            background: #000000;
            color: #ffffff;
            min-height: 100vh;
            padding: 16px;
            padding-bottom: 80px;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 16px;
            background: #1a1a1a;
            border-radius: 12px;
            margin-bottom: 20px;
        }

        .balance {
            font-size: 18px;
            font-weight: 600;
            color: #FFD700;
        }

        .add-balance {
            background: #007AFF;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
        }

        .section-title {
            font-size: 20px;
            font-weight: 700;
            margin: 20px 0;
            text-align: center;
        }

        .cases-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin: 20px 0;
        }

        .case-card {
            background: #1a1a1a;
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .case-card:hover {
            transform: scale(1.05);
        }

        .case-image {
            width: 60px;
            height: 60px;
            object-fit: contain;
            margin: 0 auto 10px;
        }

        .case-name {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .case-price {
            color: #FFD700;
            font-weight: 700;
            font-size: 16px;
        }

        .inventory {
            background: #1a1a1a;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }

        .inventory-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 15px;
            text-align: center;
        }

        .inventory-items {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .inventory-item {
            background: #2a2a2a;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
        }

        .item-name {
            font-size: 12px;
            margin-bottom: 5px;
        }

        .item-value {
            color: #FFD700;
            font-size: 11px;
        }

        .sell-btn {
            background: #FF6B6B;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 11px;
            cursor: pointer;
            margin-top: 5px;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: #1a1a1a;
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            max-width: 90%;
        }

        .won-item {
            margin: 20px 0;
        }

        .won-item img {
            width: 80px;
            height: 80px;
            object-fit: contain;
            margin-bottom: 10px;
        }

        .modal-close {
            background: #007AFF;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="balance" id="balanceAmount">0 ‚≠ê</div>
        <button class="add-balance" onclick="topUpBalance()">–ü–æ–ø–æ–ª–Ω–∏—Ç—å</button>
    </div>

    <div class="section-title">üé∞ NFT –ö–µ–π—Å—ã</div>

    <div class="cases-grid">
        <div class="case-card" onclick="openCase('common', 10)">
            <div class="case-name">–û–±—ã—á–Ω—ã–π –∫–µ–π—Å</div>
            <div class="case-price">10 ‚≠ê</div>
        </div>
        
        <div class="case-card" onclick="openCase('rare', 25)">
            <div class="case-name">–†–µ–¥–∫–∏–π –∫–µ–π—Å</div>
            <div class="case-price">25 ‚≠ê</div>
        </div>
        
        <div class="case-card" onclick="openCase('epic', 50)">
            <div class="case-name">–≠–ø–∏—á–µ—Å–∫–∏–π –∫–µ–π—Å</div>
            <div class="case-price">50 ‚≠ê</div>
        </div>
        
        <div class="case-card" onclick="openCase('legendary', 100)">
            <div class="case-name">–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π –∫–µ–π—Å</div>
            <div class="case-price">100 ‚≠ê</div>
        </div>
    </div>

    <div class="inventory">
        <div class="inventory-title">üéÅ –ú–æ–π –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å</div>
        <div class="inventory-items" id="inventoryItems">
            <!-- –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã–∏–≥—Ä—ã—à–∞ -->
    <div class="modal" id="winModal">
        <div class="modal-content">
            <h2>üéâ –ü–û–ó–î–†–ê–í–õ–Ø–ï–ú!</h2>
            <div class="won-item">
                <img id="wonItemImage" src="">
                <h3 id="wonItemName"></h3>
                <p id="wonItemValue"></p>
            </div>
            <button class="modal-close" onclick="closeModal()">OK</button>
        </div>
    </div>

    <script>
        let balance = 0;
        let inventory = [];

        // NFT –ø–æ–¥–∞—Ä–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ –∫–µ–π—Å–∞
        const nftItems = {
            common: [
                { name: "–ú–∏—à–∫–∞", value: 5, image: "üêª" },
                { name: "–°–µ—Ä–¥–µ—á–∫–æ", value: 8, image: "‚ù§Ô∏è" },
                { name: "–ó–≤–µ–∑–¥–∞", value: 10, image: "‚≠ê" }
            ],
            rare: [
                { name: "–†–∞–∫–µ—Ç–∞", value: 15, image: "üöÄ" },
                { name: "–ê–ª–º–∞–∑", value: 20, image: "üíé" },
                { name: "–ö–æ—Ä–æ–Ω–∞", value: 25, image: "üëë" }
            ],
            epic: [
                { name: "–î—Ä–∞–∫–æ–Ω", value: 30, image: "üê≤" },
                { name: "–ö–æ–ª—å—Ü–æ", value: 40, image: "üíç" },
                { name: "–°–æ–∫—Ä–æ–≤–∏—â–µ", value: 50, image: "üì¶" }
            ],
            legendary: [
                { name: "–°—É–ø–µ—Ä –∑–≤–µ–∑–¥–∞", value: 75, image: "üåü" },
                { name: "–¢—Ä–æ—Ñ–µ–π", value: 100, image: "üèÜ" },
                { name: "–õ–µ–≥–µ–Ω–¥–∞", value: 150, image: "üî•" }
            ]
        };

        function updateBalance() {
            document.getElementById('balanceAmount').textContent = balance + " ‚≠ê";
        }

        function updateInventory() {
            const container = document.getElementById('inventoryItems');
            container.innerHTML = '';

            if (inventory.length === 0) {
                container.innerHTML = '<div style="text-align: center; color: #888;">–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –ø—É—Å—Ç</div>';
                return;
            }

            inventory.forEach((item, index) => {
                const itemElement = document.createElement('div');
                itemElement.className = 'inventory-item';
                itemElement.innerHTML = `
                    <div style="font-size: 24px;">${item.image}</div>
                    <div class="item-name">${item.name}</div>
                    <div class="item-value">${item.value} ‚≠ê</div>
                    <button class="sell-btn" onclick="sellItem(${index})">–ü—Ä–æ–¥–∞—Ç—å</button>
                `;
                container.appendChild(itemElement);
            });
        }

        function openCase(caseType, price) {
            if (balance >= price) {
                balance -= price;
                updateBalance();

                // –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã–π NFT
                const items = nftItems[caseType];
                const wonItem = items[Math.floor(Math.random() * items.length)];
                
                // –î–æ–±–∞–≤–ª—è–µ–º –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å
                inventory.push(wonItem);
                updateInventory();

                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
                document.getElementById('wonItemImage').textContent = wonItem.image;
                document.getElementById('wonItemName').textContent = wonItem.name;
                document.getElementById('wonItemValue').textContent = "–¶–µ–Ω–Ω–æ—Å—Ç—å: " + wonItem.value + " ‚≠ê";
                document.getElementById('winModal').style.display = 'flex';

                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ –±–æ—Ç–∞
                if (typeof Telegram !== 'undefined' && Telegram.WebApp) {
                    Telegram.WebApp.sendData(JSON.stringify({
                        type: 'openCase',
                        caseType: caseType,
                        price: price,
                        wonItem: wonItem.name,
                        itemValue: wonItem.value
                    }));
                }

            } else {
                alert('‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–≤—ë–∑–¥! –ü–æ–ø–æ–ª–Ω–∏—Ç–µ –±–∞–ª–∞–Ω—Å.');
            }
        }

        function sellItem(index) {
            const item = inventory[index];
            balance += item.value;
            inventory.splice(index, 1);
            
            updateBalance();
            updateInventory();

            if (typeof Telegram !== 'undefined' && Telegram.WebApp) {
                Telegram.WebApp.sendData(JSON.stringify({
                    type: 'sellItem',
                    itemValue: item.value
                }));
            }
        }

        function topUpBalance() {
            if (typeof Telegram !== 'undefined' && Telegram.WebApp) {
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –Ω–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ
                Telegram.WebApp.sendData(JSON.stringify({
                    type: 'topUpBalance'
                }));
            } else {
                alert('–û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Telegram –±–æ—Ç–∞ –¥–ª—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è');
            }
        }

        function closeModal() {
            document.getElementById('winModal').style.display = 'none';
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        if (typeof Telegram !== 'undefined' && Telegram.WebApp) {
            Telegram.WebApp.ready();
            Telegram.WebApp.expand();

            // –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ —É –±–æ—Ç–∞
            Telegram.WebApp.sendData(JSON.stringify({
                type: 'getData'
            }));
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç –±–æ—Ç–∞
        if (typeof Telegram !== 'undefined' && Telegram.WebApp) {
            Telegram.WebApp.onEvent('message', (message) => {
                try {
                    const data = JSON.parse(message);
                    if (data.balance !== undefined) {
                        balance = data.balance;
                        updateBalance();
                    }
                    if (data.inventory !== undefined) {
                        inventory = data.inventory;
                        updateInventory();
                    }
                } catch (e) {
                    console.error('Error:', e);
                }
            });
        }

        updateBalance();
        updateInventory();
    </script>
</body>
</html>