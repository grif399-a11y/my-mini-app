<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NFT –ö–µ–π—Å—ã</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        :root {
            --bg-dark: #0a0a0a;
            --bg-card: #1a1a1a;
            --bg-item: #2a2a2a;
            --text-primary: #ffffff;
            --text-secondary: #cccccc;
            --accent-gold: #FFD700;
            --accent-blue: #007AFF;
            --accent-green: #00ff88;
            --accent-red: #FF6B6B;
            --accent-purple: #9370DB;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        body {
            background: var(--bg-dark);
            color: var(--text-primary);
            min-height: 100vh;
            padding: 16px;
            padding-bottom: 80px;
        }

        .container {
            max-width: 100%;
            margin: 0 auto;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 16px;
            background: var(--bg-card);
            border-radius: 12px;
            margin-bottom: 20px;
        }

        .balance {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 18px;
            font-weight: 600;
        }

        .balance-amount {
            color: var(--accent-gold);
        }

        .add-balance {
            background: var(--accent-blue);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s;
        }

        .add-balance:hover {
            background: #0056b3;
        }

        .section-title {
            font-size: 24px;
            font-weight: 700;
            margin: 20px 0;
            text-align: center;
            color: var(--accent-gold);
        }

        .cases-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin: 20px 0;
        }

        .case-card {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            border: 2px solid transparent;
        }

        .case-card:hover {
            transform: translateY(-2px);
            border-color: var(--accent-purple);
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }

        .case-image {
            width: 60px;
            height: 60px;
            object-fit: contain;
            margin: 0 auto 10px;
            border-radius: 8px;
        }

        .case-name {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text-primary);
        }

        .case-price {
            color: var(--accent-gold);
            font-weight: 700;
            font-size: 16px;
        }

        .inventory {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }

        .inventory-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 15px;
            text-align: center;
            color: var(--accent-blue);
        }

        .inventory-items {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .inventory-item {
            background: var(--bg-item);
            padding: 12px;
            border-radius: 8px;
            text-align: center;
        }

        .item-image {
            font-size: 32px;
            margin-bottom: 8px;
        }

        .item-name {
            font-size: 12px;
            margin-bottom: 5px;
            color: var(--text-primary);
        }

        .item-value {
            color: var(--accent-gold);
            font-size: 11px;
            font-weight: 600;
        }

        .sell-btn {
            background: var(--accent-red);
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 11px;
            cursor: pointer;
            margin-top: 8px;
            transition: background 0.3s;
        }

        .sell-btn:hover {
            background: #d44;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: var(--bg-card);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            max-width: 90%;
            max-height: 90%;
            overflow-y: auto;
            position: relative;
        }

        .won-item {
            margin: 20px 0;
        }

        .won-item-image {
            font-size: 64px;
            margin-bottom: 15px;
        }

        .won-item-name {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text-primary);
        }

        .won-item-value {
            color: var(--accent-gold);
            font-size: 16px;
            font-weight: 600;
        }

        .modal-close {
            background: var(--accent-blue);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 20px;
            transition: background 0.3s;
        }

        .modal-close:hover {
            background: #0056b3;
        }

        .empty-inventory {
            text-align: center;
            color: var(--text-secondary);
            padding: 20px;
        }

        @media (max-width: 480px) {
            .cases-grid {
                grid-template-columns: 1fr;
            }
            
            .inventory-items {
                grid-template-columns: 1fr;
            }
            
            .case-image {
                width: 50px;
                height: 50px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="balance">
                <span class="balance-amount" id="balanceAmount">0</span>
                <span>‚≠ê</span>
            </div>
            <button class="add-balance" onclick="topUpBalance()">
                <i class="fas fa-plus"></i> –ü–æ–ø–æ–ª–Ω–∏—Ç—å
            </button>
        </div>

        <div class="section-title">üé∞ NFT –ö–µ–π—Å—ã</div>

        <div class="cases-grid">
            <div class="case-card" onclick="openCase('common', 10)">
                <div class="case-image">üéÅ</div>
                <div class="case-name">–û–±—ã—á–Ω—ã–π –∫–µ–π—Å</div>
                <div class="case-price">10 ‚≠ê</div>
            </div>
            
            <div class="case-card" onclick="openCase('rare', 25)">
                <div class="case-image">üíé</div>
                <div class="case-name">–†–µ–¥–∫–∏–π –∫–µ–π—Å</div>
                <div class="case-price">25 ‚≠ê</div>
            </div>
            
            <div class="case-card" onclick="openCase('epic', 50)">
                <div class="case-image">üî•</div>
                <div class="case-name">–≠–ø–∏—á–µ—Å–∫–∏–π –∫–µ–π—Å</div>
                <div class="case-price">50 ‚≠ê</div>
            </div>
            
            <div class="case-card" onclick="openCase('legendary', 100)">
                <div class="case-image">üåü</div>
                <div class="case-name">–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π –∫–µ–π—Å</div>
                <div class="case-price">100 ‚≠ê</div>
            </div>
        </div>

        <div class="inventory">
            <div class="inventory-title">üéÅ –ú–æ–π –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å</div>
            <div class="inventory-items" id="inventoryItems">
                <div class="empty-inventory">
                    <i class="fas fa-box-open" style="font-size: 32px; margin-bottom: 10px;"></i>
                    <p>–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –ø—É—Å—Ç</p>
                </div>
            </div>
        </div>

        <div class="modal" id="winModal">
            <div class="modal-content">
                <h2 style="color: var(--accent-gold); margin-bottom: 20px;">üéâ –ü–û–ó–î–†–ê–í–õ–Ø–ï–ú!</h2>
                <div class="won-item">
                    <div class="won-item-image" id="wonItemImage"></div>
                    <h3 class="won-item-name" id="wonItemName"></h3>
                    <div class="won-item-value" id="wonItemValue"></div>
                </div>
                <button class="modal-close" onclick="closeModal()">OK</button>
            </div>
        </div>
    </div>

    <script>
        // NFT –ø–æ–¥–∞—Ä–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ –∫–µ–π—Å–∞
        const nftItems = {
            common: [
                { name: "–ú–∏—à–∫–∞", value: 5, image: "üêª" },
                { name: "–°–µ—Ä–¥–µ—á–∫–æ", value: 8, image: "‚ù§Ô∏è" },
                { name: "–ó–≤–µ–∑–¥–∞", value: 10, image: "‚≠ê" }
            ],
            rare: [
                { name: "–†–∞–∫–µ—Ç–∞", value: 15, image: "üöÄ" },
                { name: "–ê–ª–º–∞–∑", value: 20, image: "üíé" },
                { name: "–ö–æ—Ä–æ–Ω–∞", value: 25, image: "üëë" }
            ],
            epic: [
                { name: "–î—Ä–∞–∫–æ–Ω", value: 30, image: "üê≤" },
                { name: "–ö–æ–ª—å—Ü–æ", value: 40, image: "üíç" },
                { name: "–°–æ–∫—Ä–æ–≤–∏—â–µ", value: 50, image: "üì¶" }
            ],
            legendary: [
                { name: "–°—É–ø–µ—Ä –∑–≤–µ–∑–¥–∞", value: 75, image: "üåü" },
                { name: "–¢—Ä–æ—Ñ–µ–π", value: 100, image: "üèÜ" },
                { name: "–õ–µ–≥–µ–Ω–¥–∞", value: 150, image: "üî•" }
            ]
        };

        let balance = 0;
        let inventory = [];

        function updateBalance() {
            document.getElementById('balanceAmount').textContent = balance;
        }

        function updateInventory() {
            const container = document.getElementById('inventoryItems');
            container.innerHTML = '';

            if (inventory.length === 0) {
                container.innerHTML = `
                    <div class="empty-inventory">
                        <i class="fas fa-box-open" style="font-size: 32px; margin-bottom: 10px;"></i>
                        <p>–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –ø—É—Å—Ç</p>
                    </div>
                `;
                return;
            }

            inventory.forEach((item, index) => {
                const itemElement = document.createElement('div');
                itemElement.className = 'inventory-item';
                itemElement.innerHTML = `
                    <div class="item-image">${item.image}</div>
                    <div class="item-name">${item.name}</div>
                    <div class="item-value">${item.value} ‚≠ê</div>
                    <button class="sell-btn" onclick="sellItem(${index})">
                        <i class="fas fa-coins"></i> –ü—Ä–æ–¥–∞—Ç—å
                    </button>
                `;
                container.appendChild(itemElement);
            });
        }

        function openCase(caseType, price) {
            if (balance >= price) {
                balance -= price;
                updateBalance();

                // –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã–π NFT
                const items = nftItems[caseType];
                const wonItem = items[Math.floor(Math.random() * items.length)];
                
                // –î–æ–±–∞–≤–ª—è–µ–º –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å
                inventory.push(wonItem);
                updateInventory();

                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
                document.getElementById('wonItemImage').textContent = wonItem.image;
                document.getElementById('wonItemName').textContent = wonItem.name;
                document.getElementById('wonItemValue').textContent = "–¶–µ–Ω–Ω–æ—Å—Ç—å: " + wonItem.value + " ‚≠ê";
                document.getElementById('winModal').style.display = 'flex';

                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ –±–æ—Ç–∞
                if (typeof Telegram !== 'undefined' && Telegram.WebApp) {
                    Telegram.WebApp.sendData(JSON.stringify({
                        type: 'openCase',
                        caseType: caseType,
                        price: price,
                        wonItem: wonItem.name,
                        itemValue: wonItem.value
                    }));
                }

            } else {
                alert('‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–≤—ë–∑–¥! –ü–æ–ø–æ–ª–Ω–∏—Ç–µ –±–∞–ª–∞–Ω—Å.');
            }
        }

        function sellItem(index) {
            const item = inventory[index];
            balance += item.value;
            inventory.splice(index, 1);
            
            updateBalance();
            updateInventory();

            if (typeof Telegram !== 'undefined' && Telegram.WebApp) {
                Telegram.WebApp.sendData(JSON.stringify({
                    type: 'sellItem',
                    itemValue: item.value
                }));
            }
        }

        function topUpBalance() {
            if (typeof Telegram !== 'undefined' && Telegram.WebApp) {
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –Ω–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ
                Telegram.WebApp.sendData(JSON.stringify({
                    type: 'topUpBalance'
                }));
                
                // –ó–∞–∫—Ä—ã–≤–∞–µ–º –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —á—Ç–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–≤–∏–¥–µ–ª –º–µ–Ω—é –±–æ—Ç–∞
                setTimeout(() => {
                    Telegram.WebApp.close();
                }, 500);
                
            } else {
                alert('–î–ª—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞ –æ—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Telegram –±–æ—Ç–∞');
            }
        }

        function closeModal() {
            document.getElementById('winModal').style.display = 'none';
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram WebApp
        if (typeof Telegram !== 'undefined' && Telegram.WebApp) {
            Telegram.WebApp.ready();
            Telegram.WebApp.expand();

            // –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ —É –±–æ—Ç–∞
            Telegram.WebApp.sendData(JSON.stringify({
                type: 'getData'
            }));
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç –±–æ—Ç–∞
        if (typeof Telegram !== 'undefined' && Telegram.WebApp) {
            Telegram.WebApp.onEvent('message', (message) => {
                try {
                    const data = JSON.parse(message);
                    if (data.balance !== undefined) {
                        balance = data.balance;
                        updateBalance();
                    }
                    if (data.inventory !== undefined) {
                        inventory = data.inventory;
                        updateInventory();
                    }
                } catch (e) {
                    console.error('Error parsing message:', e);
                }
            });
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        updateBalance();
        updateInventory();
    </script>
</body>
</html>